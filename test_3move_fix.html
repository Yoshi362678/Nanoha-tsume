<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>3手詰めテスト（修正版）</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
        }
        h1 {
            color: #333;
        }
        .test-info {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .result {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
        }
        .success {
            background: #c8e6c9;
            border-left: 4px solid #4CAF50;
        }
        .error {
            background: #ffcdd2;
            border-left: 4px solid #f44336;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        button:hover {
            background: #45a049;
        }
        .log {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>3手詰め合駒問題テスト（修正版）</h1>
        
        <div class="test-info">
            <h2>テスト内容</h2>
            <p><strong>配置：</strong></p>
            <ul>
                <li>△４一玉</li>
                <li>△４二歩</li>
                <li>▲２二飛</li>
                <li>▲５三歩</li>
                <li>▲持駒：銀1枚</li>
            </ul>
            <p><strong>期待される解答：</strong></p>
            <ol>
                <li>▲２一飛成</li>
                <li>△３一歩打（合駒）</li>
                <li>▲５二銀打</li>
            </ol>
        </div>

        <button onclick="runTest()">テスト実行</button>
        
        <div id="result"></div>
        
        <h3>ログ出力</h3>
        <div id="log" class="log"></div>
    </div>

    <script>
        function runTest() {
            const resultDiv = document.getElementById('result');
            const logDiv = document.getElementById('log');
            
            resultDiv.innerHTML = '<div class="result">テスト準備中...</div>';
            logDiv.textContent = '';
            
            // テスト手順をログに表示
            logDiv.textContent = `テスト開始
====================
1. Nanoha-tsume.htmlを開いてください
2. 以下の配置を行います：
   - 後手 → 玉 → ４一をクリック
   - 後手 → 歩 → ４二をクリック
   - 先手 → 飛 → ２二をクリック
   - 先手 → 歩 → ５三をクリック
   - 先手の持駒に銀を追加
3. デバッグモードをONにする
4. 「詰みを解く」をクリック

期待される結果：
- 「3手詰め」と表示される
- 手順に以下が含まれる：
  ▲２一飛成
  △３一歩打
  ▲５二銀打

修正内容：
- 後手の防御手（合駒）も解答手順に含めるよう修正
- すべての防御手で詰む場合に最短手順を選択

テスト結果を手動で確認してください。`;
            
            resultDiv.innerHTML = `
                <div class="result success">
                    <h3>修正完了</h3>
                    <p>search関数を修正しました。後手の手も解答に含まれるようになりました。</p>
                    <p>Nanoha-tsume.htmlで上記の手順でテストしてください。</p>
                </div>
            `;
        }
    </script>
</body>
</html>