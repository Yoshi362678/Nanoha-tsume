# なのは詰将棋エンジン (Nanoha Tsume Shogi Engine)

🎯 ブラウザベースの詰将棋解析エンジン - A browser-based Tsume Shogi (Japanese chess puzzle) solver

## 概要 (Overview)

単一HTMLファイルで動作する完全な詰将棋解析エンジンです。外部依存なし、ビルド不要で、任意のブラウザで即座に実行可能です。

A complete Tsume Shogi solving engine that runs in a single HTML file. No external dependencies, no build process required - just open in any modern browser.

## 主な機能 (Features)

- ✅ **詰将棋解析**: 1手詰めから複雑な合駒を含む詰将棋まで対応
- ✅ **インタラクティブUI**: クリックで駒配置、ドラッグ＆ドロップ対応
- ✅ **高速探索アルゴリズム**: ミニマックス＋アルファベータ枝刈り
- ✅ **合駒生成**: 後手の合駒（移動/打ち）を完全実装
- ✅ **成る/成らず**: 両方の手を適切に生成
- ✅ **千日手検出**: 無限ループ防止機能
- ✅ **デバッグモード**: 詳細な探索ログ表示

## 使い方 (Usage)

### 簡単スタート
1. `Nanoha-tsume.html`をブラウザで開く
2. 駒を配置（クリックで選択→盤面クリックで配置）
3. 「詰みを解く」ボタンをクリック

### 配置方法
- 先手/後手を選択
- 駒種を選択
- 盤面をクリックして配置
- 持駒は「先手の持駒に追加」から

### 例題
内蔵の例題：
- 1手詰め（基本）
- 3手詰め（持駒使用）
- 3手詰め（合駒問題）

## 技術仕様 (Technical Specifications)

### アルゴリズム
- **探索**: ミニマックス法 + アルファベータ枝刈り
- **評価**: 詰み/不詰みの二値評価
- **最適化**: 
  - ハッシュテーブル（置換表）
  - キラームーブヒューリスティック
  - 反復深化

### 制限値
- 最大探索深さ: 25手
- 最大ノード数: 20,000
- タイムアウト: 10秒
- 千日手判定: 同一局面2回

### 座標系
- 日本式表記（９一〜１九）
- 内部: 0-indexed配列[row][col]

## ファイル構成

```
nanoha_tsume/
├── Nanoha-tsume.html          # メインエンジン
├── README.md                  # このファイル
├── CLAUDE.md                  # 開発ドキュメント
└── tests/                     # テストファイル群
    ├── test_3te_aigoma.html   # 3手詰め合駒テスト
    └── unit-tests.html        # 単体テスト
```

## 開発状況

### 完成機能 ✅
- 基本的な詰将棋探索
- 王手生成・回避
- 合駒生成（移動＋打ち）
- 成る/成らず両方の手生成
- 千日手検出
- UI（駒配置、保存/読込）

### 既知の問題
- 5手以上の深い詰みは時間がかかる場合がある
- 複雑な合駒問題で稀に最善手を見逃す可能性

## ライセンス

MIT License

## 開発者

- 初期開発: Claude Code (Anthropic)
- メンテナ: Yoshi362678

## 貢献

Issue報告やPull Requestを歓迎します。

## 謝辞

このプロジェクトは詰将棋の美しさと、その解析の面白さを多くの人に伝えることを目的としています。

---

*"詰将棋は、限られた駒と盤面で無限の可能性を探る芸術である"*